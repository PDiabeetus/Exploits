local VirtualUser = game:GetService("VirtualUser")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local MinimizeKeybind = Enum.KeyCode.End
local Minimized = false

local GUIInstance = game.CoreGui

local ScreenGUI = Instance.new("ScreenGui", GUIInstance)
local Frame = Instance.new("Frame", ScreenGUI)
local UICorner = Instance.new("UICorner", Frame)
local StatusLabel = Instance.new("TextLabel", Frame)
local ToggleButton = Instance.new("TextButton", Frame)
local UIStroke = Instance.new("UIStroke", ToggleButton)
local UICorner0 = Instance.new("UICorner", ToggleButton)
local UIPadding = Instance.new("UIPadding", ToggleButton)

local Cooldown = false
local CooldownTime = 0.5

local Status = "Disabled"

local DefaultTextColor = Color3.new(0.866667, 0.866667, 0.866667)
local DefaultCornerRadius = UDim.new(0, 5)

local IdleFunction = nil
local Toggle = nil
local Input = nil

ScreenGUI.Name = "AntiAFK"

Frame.Position = UDim2.new(0.78, 0, 0.76 ,0)
Frame.Size = UDim2.new(0.2, 0, 0.2, 0)
Frame.BackgroundColor3 = Color3.new(0.137255, 0.137255, 0.137255)

UICorner.CornerRadius = DefaultCornerRadius

StatusLabel.Position = UDim2.new(0.1, 0, 0.08, 0)
StatusLabel.Size = UDim2.new(0.8, 0, 0.3, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "Status: "..Status
StatusLabel.TextColor3 = DefaultTextColor
StatusLabel.TextScaled = true
StatusLabel.Font = Enum.Font.FredokaOne
StatusLabel.Name = "Status"

ToggleButton.Position = UDim2.new(0.1, 0, 0.45, 0)
ToggleButton.Size = UDim2.new(0.8, 0, 0.4, 0)
ToggleButton.BackgroundColor3 = Color3.new(0.192157, 0.192157, 0.192157)
ToggleButton.Text = "Toggle"
ToggleButton.TextColor3 = DefaultTextColor
ToggleButton.TextScaled = true
ToggleButton.Font = Enum.Font.FredokaOne
ToggleButton.Name = "ToggleButton"

UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
UIStroke.Thickness = 3
UIStroke.Transparency = 0.8

UICorner0.CornerRadius = DefaultCornerRadius

UIPadding.PaddingBottom = UDim.new(0.1, 0)

local FramePosition = Frame.Position

Toggle = ToggleButton.MouseButton1Down:Connect(function()
	if Cooldown == true then return end
	if Status == "Disabled" then
		Status = "Enabled"
		StatusLabel.Text = "Status: "..Status
		IdleFunction = game.Players.LocalPlayer.Idled:Connect(function()
			VirtualUser:CaptureController()
			VirtualUser:ClickButton2(Vector2.new())
		end)
		Cooldown = true
		wait(CooldownTime)
		Cooldown = false
	elseif Status == "Enabled" then
		Status = "Disabled"
		StatusLabel.Text = "Status: "..Status
		IdleFunction:Disconnect()
		Cooldown = true
		wait(CooldownTime)
		Cooldown = false
	end
end)

Input = UserInputService.InputBegan:Connect(function(Key, GameProcessedEvent)
	if GameProcessedEvent or Cooldown == true then return end
	if Key.KeyCode == MinimizeKeybind then
		if Minimized == false then
			Minimized = true
			Frame:TweenPosition(UDim2.new(1.1, 0, FramePosition.Y.Scale, 0), Enum.EasingDirection.InOut, Enum.EasingStyle.Quart)
			Cooldown = true
			wait(CooldownTime)
			Cooldown = false
		elseif Minimized == true then
			Minimized = false
			Frame:TweenPosition(UDim2.new(FramePosition.X.Scale, 0, FramePosition.Y.Scale, 0), Enum.EasingDirection.InOut, Enum.EasingStyle.Elastic)
			Cooldown = true
			wait(CooldownTime)
			Cooldown = false
		end
	end
end)
